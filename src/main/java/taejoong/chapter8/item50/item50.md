# 적시에 방어적 복사본을 만들라 
- 요약
  - 클라이언트가 여러분의 불변식을 깨뜨리려 혈안이 되어 있다고 가정하고 방어적으로 프로그래밍해야 한다.
  - Date는 낡은 API이니 새로운 코드를 작성할 때는 더 이상 사용하면 안된다.
  - 매개변수의 유효성을 검사하기전에 방어적 복사본을 만들고, 이 복사본으로 유효성을 검사해라. 멀티스레딩 환경이라면 원본 객체의 유효성을 검사한 후 복사본을 만드는 그 찰나의 취약한 순간에 다른 스레드가 원본 객체를 수정할 위험이 있기 때문이다.
  - 매개변수가 제3자에 의해 확장될 수 있는 타입이라면 방어적 복사본을 만들 때 clone을 사용해서는 안된다.
  - 접근자가 가변 필드의 방어적 복사본을 반환하도록 해라.
  - 방어적 복사에는 성능 저하가 따른다.
  - 되도록 불변 객체들을 조합해 객체를 구성해야 방어적 복사를 할 일이 줄어든다. 책의 Period 예제를 작성할 때 Date 보다는 Instant를 이용하고, Date를 이용해야한다면 getTime()이 반환하는 long 정수를 이용하는 방법도 있다.
- 질문