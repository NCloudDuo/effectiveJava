# 가능한 한 실패 원자적으로 만들라

### 호출된 메서드가 실패하더라도, 해당 객체는 메서드 호출 전 상태를 유지행햐ㅏㄴ다.
+ 이러한 특성을 실패 원자적(failure-atomic)이라고 한다.

### 메서드를 실패 원자적으로 만드는 다양한 방법
+ 불변 객체로 설계하기
  + 불변 객체의 상태는 생성 시점에 고정되어, 절대 변하지 않기 때문이다.
+ 가변 객체의 메서드를 실패 원자적으로 만드는 가장 흔한 방법은, 작업 수행에 앞서 매개변수의 유효성을 검사하는 것
  + 객체의 내부 상태를 변경하기전에, 잠재적 예외 가능성 대부분을 걸러낼 수 있는 방법이다.
  ```java
  ///stack.pop 메서드의 예시
  public Object pop(){
  if(size==0){
    throw new EmptyStackException(); 
  }
  }
  ```
+ 실패할 가능성이 있는 모든 코드를, 객체의 상태를 바꾸는 코드보다 앞에 배치하는 방법도 있다.
  + TreeMap의 예에서, 원소를 삽입하려고 할때, 정렬기준이 정해져 있지 않다면, `ClassCastException`을 던질 것이다.

+ 실패 원자성을 얻는 세번째 방법은 객체의 임시 복사본에서 작업을 수행한 다음, 작업이 성공적으로 완료되면, 원래 객체와 교체하는것이다.
